(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{456:function(s,e,a){"use strict";a.r(e);var n=a(2),t=Object(n.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("![image-20231025100819430](深入了解 Elasticsearch 8.1 中的 Script 使用.assets\\image-20231025100819430.png)")]),s._v(" "),e("h1",{attrs:{id:"一、什么是-elasticsearch-script"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、什么是-elasticsearch-script"}},[s._v("#")]),s._v(" 一、什么是 Elasticsearch Script？")]),s._v(" "),e("p",[e("code",[s._v("Elasticsearch")]),s._v(" 中的  "),e("code",[s._v("Script")]),s._v("  是一种灵活的方式，允许用户在查询、聚合和更新文档时执行自定义的脚本。这些脚本可以用来动态计算字段值、修改查询行为、执行复杂的条件逻辑等等。")]),s._v(" "),e("h1",{attrs:{id:"二、支持的脚本语言有哪些"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、支持的脚本语言有哪些"}},[s._v("#")]),s._v(" 二、支持的脚本语言有哪些")]),s._v(" "),e("p",[s._v("支持多种脚本语言，包括 "),e("strong",[s._v("Painless")]),s._v("、"),e("strong",[s._v("Expression")]),s._v("、"),e("strong",[s._v("Mustache")]),s._v("、"),e("strong",[s._v("Java")]),s._v("等，其中默认的是"),e("strong",[s._v("Painless")]),s._v("。")]),s._v(" "),e("p",[s._v("![image-20231024120432403](深入了解 Elasticsearch 8.1 中的 Script 使用.assets\\image-20231024120432403.png)")]),s._v(" "),e("h1",{attrs:{id:"三、painless-脚本的使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、painless-脚本的使用"}},[s._v("#")]),s._v(" 三、Painless 脚本的使用")]),s._v(" "),e("p",[e("strong",[s._v("Painless")]),s._v(" 是一种专为 "),e("strong",[s._v("Elasticsearch")]),s._v(" 设计的脚本语言，具有安全、快速、简单的特点，使其在 "),e("strong",[s._v("Elasticsearch")]),s._v(" 中非常方便入门。")]),s._v(" "),e("ol",[e("li",[e("p",[e("strong",[s._v("安全性：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 被设计为一种安全的脚本语言。它采取了一系列的安全措施，如禁止无限循环、禁止访问 "),e("strong",[s._v("Java")]),s._v(" 类库中的危险类等，以减轻潜在的安全风险。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("高性能：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 是为高性能而设计的，特别是在 Elasticsearch 中。它经过了优化，可以在大规模数据集上快速执行。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("易学易用：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 实现了任何具有基本编码经验的人都自然熟悉的语法。"),e("strong",[s._v("Painless")]),s._v(" 使用 Java 语法的子集，并进行了一些额外的改进，以增强可读性并删除样板文件。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("无需编译：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 脚本不需要预先编译。它可以在运行时解释，所以我们可以动态调整脚本而无需重新编译整个应用程序。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("支持参数化：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 允许在脚本中使用参数，这可以使脚本更通用，适用于多种情况。参数化脚本可以接受外部传递的值，从而在不修改脚本的情况下改变其行为。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("支持多种数据类型：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 支持多种数据类型，包括数字、字符串、日期、布尔值等。")])]),s._v(" "),e("li",[e("p",[e("strong",[s._v("集成性：")]),s._v(" "),e("strong",[s._v("Painless")]),s._v(" 被紧密集成到 "),e("strong",[s._v("Java")]),s._v(" 中，可以用于查询、聚合、脚本字段、脚本排序等各种用例。")])])]),s._v(" "),e("h2",{attrs:{id:"_3-1、编写我们的第一个脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-1、编写我们的第一个脚本"}},[s._v("#")]),s._v(" 3.1、编写我们的第一个脚本")]),s._v(" "),e("blockquote",[e("p",[s._v("使用的 "),e("code",[s._v("Elasticsearch")]),s._v(" 版本为 "),e("code",[s._v("8.1")]),s._v("，历史文章除非特别说明，最近更文的 "),e("code",[s._v("ES")]),s._v("版本都为 "),e("code",[s._v("Elasticsearch")]),s._v(" 的 "),e("code",[s._v("8.1")]),s._v(" 版本")])]),s._v(" "),e("p",[s._v("脚本的组成有三个参数，只要是在 "),e("strong",[s._v("Elasticsearch")]),s._v(" "),e("strong",[s._v("API")]),s._v(" 支持脚本的地方，都可以使用如下三个参数来使用脚本。")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(' "script": {\n    "lang":   "...",\n    "source" | "id": "...",\n    "params": { ... }\n  }\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])]),e("ul",[e("li",[e("code",[s._v("lang")]),s._v("：执行脚本语言类型，默认"),e("code",[s._v("painless")])]),s._v(" "),e("li",[e("code",[s._v("source，id")]),s._v("：脚本的源码本身，或者提前存储的"),e("code",[s._v("脚本ID")])]),s._v(" "),e("li",[e("code",[s._v("params")]),s._v("：作为变量传递给脚本的参数")])]),s._v(" "),e("p",[s._v("下面我们将通过实际的例子来进行说明")]),s._v(" "),e("h2",{attrs:{id:"_3-2、在检索中使用脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-2、在检索中使用脚本"}},[s._v("#")]),s._v(" 3.2、在检索中使用脚本")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("首先我们先往索引中插入一篇文档")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('PUT zfc-doc-000007/_doc/1\n{\n  "sum": 5,\n  "message":"test painless"\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("使用脚本实现"),e("code",[s._v("sum")]),s._v("的值 "),e("code",[s._v("乘2")]),s._v("，此处使用变量 "),e("code",[s._v("multiplie")]),s._v("r，在脚本的参数中指定参数值为"),e("code",[s._v("2")]),s._v("，其中"),e("code",[s._v("doc['sum'].value * params['multiplier']")]),s._v("的意思就是获取文档中"),e("code",[s._v("sum")]),s._v("的值并乘以脚本中 "),e("code",[s._v("multiplier")]),s._v("的值")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('GET zfc-doc-000007/_search\n{\n  "script_fields": {\n    "my_doubled_field": {\n      "script": { \n        "source": "doc[\'sum\'].value * params[\'multiplier\']", \n        "params": {\n          "multiplier": 2\n        }\n      }\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("在获取脚本的参数中的变量值除了使用"),e("code",[s._v("params['参数名']")]),s._v("这种方式之外，还可以使用"),e("code",[s._v("params.get('multiplier')")]),s._v("方法获取")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('GET zfc-doc-000007/_search\n{\n  "script_fields": {\n    "my_doubled_field": {\n      "script": {\n        "lang":   "painless",\n        "source": "doc[\'sum\'].value * params.get(\'multiplier\');",\n        "params": {\n          "multiplier": 2\n        }\n      }\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])])])]),s._v(" "),e("p",[s._v("上面我们是在检索请求中使用的脚本字段来使用的脚本，下面我们先内置一个脚本，通过使用"),e("code",[s._v("脚本ID")]),s._v("来使用内置的脚本")]),s._v(" "),e("h2",{attrs:{id:"_3-3、使用内置的脚本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-3、使用内置的脚本"}},[s._v("#")]),s._v(" 3.3、使用内置的脚本")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("创建一个脚本"),e("code",[s._v("calculate-score")]),s._v("，它可以使用"),e("code",[s._v("Math.log(_score * 2) + params['my_modifier']")]),s._v("修改分数值")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST _scripts/calculate-score\n{\n  "script": {\n    "lang": "painless",\n    "source": "Math.log(_score * 2) + params[\'my_modifier\']"\n  }\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("创建完成的脚本我们可以使用"),e("code",[s._v("_script")]),s._v("API查看脚本的内容")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("GET _scripts/calculate-score\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("在检索中只需要如下指定"),e("code",[s._v("脚本的ID")]),s._v("即可进行检索时使用")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('GET zfc-doc-000007/_search\n{\n  "query": {\n    "script_score": {\n      "query": {\n        "match": {\n            "message": "painless"\n        }\n      },\n      "script": {\n        "id": "calculate-score", \n        "params": {\n          "my_modifier": 2\n        }\n      }\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("如果想删除脚本只需要调用"),e("code",[s._v("DELETE")]),s._v("即可")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("DELETE _scripts/calculate-score\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])])]),s._v(" "),e("p",[s._v("下面我们再来演示一下如何使用脚本更新文档中的内容")]),s._v(" "),e("h2",{attrs:{id:"_3-4、使用脚本操作文档"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-4、使用脚本操作文档"}},[s._v("#")]),s._v(" 3.4、使用脚本操作文档")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("先添加一个文档来进行测试")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('PUT zfc-doc-000007/_doc/1\n{\n  "counter" : 1,\n  "tags" : ["red"]\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("使用脚本对文档中的 "),e("code",[s._v("counter")]),s._v(" 的值与脚本中的 "),e("code",[s._v("count")]),s._v("值进行相加")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\nPOST zfc-doc-000007/_update/1\n{\n  "script" : {\n    "source": "ctx._source.counter += params.count",\n    "lang": "painless",\n    "params" : {\n      "count" : 4\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("我们还可以对文档中的数组类型的"),e("code",[s._v("tags")]),s._v("字段进行增加子对象，比如增加一个"),e("code",[s._v("blue")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST zfc-doc-000007/_update/1\n{\n  "script": {\n    "source": "ctx._source.tags.add(params[\'tag\'])",\n    "lang": "painless",\n    "params": {\n      "tag": "blue"\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("使用脚本对文档中的 "),e("code",[s._v("tags")]),s._v(" 的值进行删除，条件就是当 "),e("code",[s._v("tag")]),s._v(" 的值与脚本中的值相等时删除。如下为当 "),e("code",[s._v("tags")]),s._v(" 的值为"),e("code",[s._v("blue")]),s._v("时，删除"),e("code",[s._v("blue")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST zfc-doc-000007/_update/1\n{\n  "script": {\n    "source": "if (ctx._source.tags.contains(params[\'tag\'])) { ctx._source.tags.remove(ctx._source.tags.indexOf(params[\'tag\'])) }",\n    "lang": "painless",\n    "params": {\n      "tag": "blue"\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上面只是对已有字段的增加删除修改，下面还可以使用脚本进行新字段的增加，比如增加一个字段"),e("code",[s._v("new_field")]),s._v("，值是"),e("code",[s._v("value_of_new_field")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST zfc-doc-000007/_update/1\n{\n  "script" : "ctx._source.new_field = \'value_of_new_field\'"\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("上面是字段的增加，下面就是字段的移除")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST zfc-doc-000007/_update/1\n{\n  "script" : "ctx._source.remove(\'new_field\')"\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("除了对字段的删除，数组对象内部值的删除，还可以对文档进行删除。如下，当 "),e("code",[s._v("tags")]),s._v(" 里面包含 "),e("code",[s._v("blue")]),s._v(" 时，删除当前文档")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST zfc-doc-000007/_update/1\n{\n  "script": {\n    "source": "if (ctx._source.tags.contains(params[\'tag\'])) { ctx.op = \'delete\' } else { ctx.op = \'none\' }",\n    "lang": "painless",\n    "params": {\n      "tag": "blue"\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])]),s._v(" "),e("h2",{attrs:{id:"_3-5、使用脚本解析日志信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-5、使用脚本解析日志信息"}},[s._v("#")]),s._v(" 3.5、使用脚本解析日志信息")]),s._v(" "),e("p",[s._v("所谓的解析字符串，只是一组固定格式的字符串，提前使用变量的形式编译，在插入文档时，通过脚本进行解析保存，方便后面的检索等请求")]),s._v(" "),e("p",[s._v("假如我们有如下数据")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('"message" : "247.37.0.0 - - [30/Apr/2020:14:31:22 -0500] \\"GET /images/hm_nbg.jpg HTTP/1.0\\" 304 0"\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("那么我们可以使用如下变量的形式解析该字符串")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('%{clientip} %{ident} %{auth} [%{@timestamp}] \\"%{verb} %{request} HTTP/%{httpversion}\\" %{status} %{size}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("下面我们使用例子来说明脚本解析字符串之后是何种形式的存在")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("创建一个索引保存解析的数据")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('PUT zfc-doc-000008\n{\n  "mappings": {\n    "properties": {\n      "message": {\n        "type": "wildcard"\n      }\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("内置一个脚本，实现解析字符串信息，并提取需要的信息，如下为提取当前日志中的 "),e("code",[s._v("http")]),s._v(" 响应信息"),e("code",[s._v("response")]),s._v("，对于如下脚本的"),e("strong",[s._v("测试API")]),s._v("使用详情可以参考官网")]),s._v(" "),e("blockquote",[e("p",[s._v("https://www.elastic.co/guide/en/elasticsearch/painless/8.1/painless-execute-api.html")])]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST /_scripts/painless/_execute\n{\n  "script": {\n    "source": """\n      String response=dissect(\'%{clientip} %{ident} %{auth} [%{@timestamp}] "%{verb} %{request} HTTP/%{httpversion}" %{response} %{size}\').extract(doc["message"].value)?.response;\n        if (response != null) emit(Integer.parseInt(response)); \n    """\n  },\n  "context": "long_field", \n  "context_setup": {\n    "index": "zfc-doc-000008",\n    "document": {          \n      "message": """247.37.0.0 - - [30/Apr/2020:14:31:22 -0500] "GET /images/hm_nbg.jpg HTTP/1.0" 304 0"""\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br")])])])]),s._v(" "),e("p",[s._v("如果我们还想操作当前解析的数据我们可以使用运行时字段，因为运行时字段不需要进行索引会更加的灵活，可以很方便的修改脚本及运行方式。")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("那么我们现在删除一下刚刚创建的索引，重新添加一下，创建语句如下")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('DELETE zfc-doc-000008\nPUT /zfc-doc-000008\n{\n  "mappings": {\n    "properties": {\n      "@timestamp": {\n        "format": "strict_date_optional_time||epoch_second",\n        "type": "date"\n      },\n      "message": {\n        "type": "wildcard"\n      }\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("添加一个运行时字段来保存解析的结果")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('PUT zfc-doc-000008/_mappings\n{\n  "runtime": {\n    "http.response": {\n      "type": "long",\n      "script": """\n        String response=dissect(\'%{clientip} %{ident} %{auth} [%{@timestamp}] "%{verb} %{request} HTTP/%{httpversion}" %{response} %{size}\').extract(doc["message"].value)?.response;\n        if (response != null) emit(Integer.parseInt(response));\n      """\n    }\n  }\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("添加几条测试数据用于测试")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('POST /zfc-doc-000008/_bulk?refresh=true\n{"index":{}}\n{"timestamp":"2020-04-30T14:30:17-05:00","message":"40.135.0.0 - - [30/Apr/2020:14:30:17 -0500] \\"GET /images/hm_bg.jpg HTTP/1.0\\" 200 24736"}\n{"index":{}}\n{"timestamp":"2020-04-30T14:30:53-05:00","message":"232.0.0.0 - - [30/Apr/2020:14:30:53 -0500] \\"GET /images/hm_bg.jpg HTTP/1.0\\" 200 24736"}\n{"index":{}}\n{"timestamp":"2020-04-30T14:31:12-05:00","message":"26.1.0.0 - - [30/Apr/2020:14:31:12 -0500] \\"GET /images/hm_bg.jpg HTTP/1.0\\" 200 24736"}\n{"index":{}}\n{"timestamp":"2020-04-30T14:31:19-05:00","message":"247.37.0.0 - - [30/Apr/2020:14:31:19 -0500] \\"GET /french/splash_inet.html HTTP/1.0\\" 200 3781"}\n{"index":{}}\n{"timestamp":"2020-04-30T14:31:22-05:00","message":"247.37.0.0 - - [30/Apr/2020:14:31:22 -0500] \\"GET /images/hm_nbg.jpg HTTP/1.0\\" 304 0"}\n{"index":{}}\n{"timestamp":"2020-04-30T14:31:27-05:00","message":"252.0.0.0 - - [30/Apr/2020:14:31:27 -0500] \\"GET /images/hm_bg.jpg HTTP/1.0\\" 200 24736"}\n{"index":{}}\n{"timestamp":"2020-04-30T14:31:28-05:00","message":"not a valid apache log"}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("下面我们进行运行时字段检索响应为"),e("code",[s._v("304")]),s._v("的数据")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\nGET zfc-doc-000008/_search\n{\n  "query": {\n    "match": {\n      "http.response": "304"\n    }\n  },\n  "fields" : ["http.response"]\n}\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("刚才是属于提前内置好运行时字段，我们也可以直接在检索时指定运行时字段来使用，但下面所示的仅在运行时有效。如下所示")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('GET zfc-doc-000008/_search\n{\n  "runtime_mappings": {\n    "http.response": {\n      "type": "long",\n      "script": """\n        String response=dissect(\'%{clientip} %{ident} %{auth} [%{@timestamp}] "%{verb} %{request} HTTP/%{httpversion}" %{response} %{size}\').extract(doc["message"].value)?.response;\n        if (response != null) emit(Integer.parseInt(response));\n      """\n    }\n  },\n  "query": {\n    "match": {\n      "http.response": "304"\n    }\n  },\n  "fields" : ["http.response"]\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])])])]),s._v(" "),e("p",[s._v("我们也可以根据特定的值进行拆分，获取所需要的信息")]),s._v(" "),e("h2",{attrs:{id:"_3-6、使用脚本解析-gc-信息"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-6、使用脚本解析-gc-信息"}},[s._v("#")]),s._v(" 3.6、使用脚本解析 GC 信息")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("例如如下 "),e("code",[s._v("Elasticsearch")]),s._v(" 的 "),e("code",[s._v("GC")]),s._v(" 信息")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[2021-04-27T16:16:34.699+0000][82460][gc,heap,exit]   class space    used 266K, capacity 384K, committed 384K, reserved 1048576K\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("下面我们根据 "),e("code",[s._v("GC")]),s._v(" 信息编写一个解析模式")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("[%{@timestamp}][%{code}][%{desc}]  %{ident} used %{usize}, capacity %{csize}, committed %{comsize}, reserved %{rsize}\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("然后在检索时就可以使用如下语句来提交信息到运行时字段，首先添加测试数据，注意索引名称已经更换，解析模式不匹配会报错")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\nPOST /zfc-doc-000010/_bulk?refresh\n{"index":{}}\n{"gc": "[2021-04-27T16:16:34.699+0000][82460][gc,heap,exit]   class space    used 266K, capacity 384K, committed 384K, reserved 1048576K"}\n{"index":{}}\n{"gc": "[2021-03-24T20:27:24.184+0000][90239][gc,heap,exit]   class space    used 15255K, capacity 16726K, committed 16844K, reserved 1048576K"}\n{"index":{}}\n{"gc": "[2021-03-24T20:27:24.184+0000][90239][gc,heap,exit]  Metaspace       used 115409K, capacity 119541K, committed 120248K, reserved 1153024K"}\n{"index":{}}\n{"gc": "[2021-04-19T15:03:21.735+0000][84408][gc,heap,exit]   class space    used 14503K, capacity 15894K, committed 15948K, reserved 1048576K"}\n{"index":{}}\n{"gc": "[2021-04-19T15:03:21.735+0000][84408][gc,heap,exit]  Metaspace       used 107719K, capacity 111775K, committed 112724K, reserved 1146880K"}\n{"index":{}}\n{"gc": "[2021-04-27T16:16:34.699+0000][82460][gc,heap,exit]  class space  used 266K, capacity 367K, committed 384K, reserved 1048576K"}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("使用检索语句展示解析数据到运行时字段中")]),s._v(" "),e("div",{staticClass:"language-text line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('GET zfc-doc-000010/_search\n{\n  "runtime_mappings": {\n    "gc_size": {\n      "type": "keyword",\n      "script": """\n        Map gc=dissect(\'[%{@timestamp}][%{code}][%{desc}]  %{ident} used %{usize}, capacity %{csize}, committed %{comsize}, reserved %{rsize}\').extract(doc["gc.keyword"].value);\n        if (gc != null) emit("used" + \' \' + gc.usize + \', \' + "capacity" + \' \' + gc.csize + \', \' + "committed" + \' \' + gc.comsize);\n      """\n    }\n  },\n  "size": 1,\n  "aggs": {\n    "sizes": {\n      "terms": {\n        "field": "gc_size",\n        "size": 10\n      }\n    }\n  },\n  "fields" : ["gc_size"]\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br")])])])]),s._v(" "),e("p",[s._v("通过上面的查询测试可以知道，"),e("code",[s._v("Elasticsearch")]),s._v(" 中的 "),e("code",[s._v("script")]),s._v(" 默认的时 "),e("code",[s._v("painless")]),s._v(" 语言，功能已经非常强大可以满足我们的日常需求，如果还想更高级的脚本，可以使用 "),e("code",[s._v("Java")]),s._v(" 语言来编写自己的脚本。关于 "),e("code",[s._v("Expressions")]),s._v(" 的表达式的使用就参与官网吧，本文的所有例子均来自官网，并自测完成。如有错误欢迎指出，共同进步。")]),s._v(" "),e("p",[s._v("后面有机会会出现一片使用Java编译脚本的使用，等后面时间吧，最近这段时间听尴尬的，也托更很久了，以后慢慢的都要补上。")]),s._v(" "),e("p",[s._v("2023 最后俩月了，加油。")]),s._v(" "),e("p",[s._v("原文链接")]),s._v(" "),e("p",[e("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/8.1/modules-scripting.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.elastic.co/guide/en/elasticsearch/reference/8.1/modules-scripting.html"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=t.exports}}]);