(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{444:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("p",[s._v("总进度")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/x7lMmMAo2563JysMJ8vgRQ",target:"_blank",rel:"noopener noreferrer"}},[s._v("Elasticsearch 8.1 认证工程师学习路线"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("今天我们来学习"),n("code",[s._v("Elasticsearch")]),s._v("中的动态模版，其实我们在第一课2.2.3章节中就已经学过了类似的了，链接如下")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://mp.weixin.qq.com/s/OnXeESVMreYgBvbGGR4R0g",target:"_blank",rel:"noopener noreferrer"}},[s._v("根据给定的需求创建索引"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("但是今天咱们学点不一样的，上次只是简单的使用，这次咱要深入理解，完美掌控才是第一目标，废话少说，下面开始")]),s._v(" "),n("h1",{attrs:{id:"什么是动态模版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是动态模版"}},[s._v("#")]),s._v(" 什么是动态模版")]),s._v(" "),n("p",[s._v("动态模版允许我们控制动态字段映射规则之外的数据")]),s._v(" "),n("p",[s._v("动态字段的映射我们可以设置"),n("code",[s._v("dynamic")]),s._v("参数为"),n("code",[s._v("true")]),s._v("或者"),n("code",[s._v("runtime")]),s._v("来启用动态映射，也可以自定义动态映射模版自定义映射，自定义之后的模版就可以根据匹配规则应用于动态添加的字段。在上一节中，动态映射规则已经说过，本节直接搬过来，如下")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("code",[s._v("JSON data type")])]),s._v(" "),n("th",[n("code",[s._v('"dynamic":"true"')])]),s._v(" "),n("th",[n("code",[s._v('"dynamic":"runtime"')])])])]),s._v(" "),n("tbody",[n("tr",[n("td",[n("code",[s._v("null")])]),s._v(" "),n("td",[s._v("不添加")]),s._v(" "),n("td",[s._v("不添加")])]),s._v(" "),n("tr",[n("td",[n("code",[s._v("true or false")])]),s._v(" "),n("td",[n("code",[s._v("boolean")])]),s._v(" "),n("td",[n("code",[s._v("boolean")])])]),s._v(" "),n("tr",[n("td",[n("code",[s._v("double")])]),s._v(" "),n("td",[n("code",[s._v("float")])]),s._v(" "),n("td",[n("code",[s._v("double")])])]),s._v(" "),n("tr",[n("td",[n("code",[s._v("long")])]),s._v(" "),n("td",[n("code",[s._v("long")])]),s._v(" "),n("td",[n("code",[s._v("long")])])]),s._v(" "),n("tr",[n("td",[n("code",[s._v("object")])]),s._v(" "),n("td",[n("code",[s._v("object")])]),s._v(" "),n("td",[s._v("不添加")])]),s._v(" "),n("tr",[n("td",[n("code",[s._v("array")])]),s._v(" "),n("td",[s._v("根据数组中第一个非空的值判断")]),s._v(" "),n("td",[s._v("根据数组中第一个非空的值判断")])]),s._v(" "),n("tr",[n("td",[s._v("日期类型的字符串")]),s._v(" "),n("td",[n("code",[s._v("date")])]),s._v(" "),n("td",[n("code",[s._v("date")])])]),s._v(" "),n("tr",[n("td",[s._v("数字类型的字符串")]),s._v(" "),n("td",[n("code",[s._v("float or long")])]),s._v(" "),n("td",[n("code",[s._v("double or long")])])]),s._v(" "),n("tr",[n("td",[s._v("不是日期也不是数字的字符串")]),s._v(" "),n("td",[n("code",[s._v("text")]),s._v("类型以及"),n("code",[s._v(".keyword")]),s._v("的字类型")]),s._v(" "),n("td",[n("code",[s._v("keyword")])])])])]),s._v(" "),n("p",[s._v("其中自定义动态模版匹配规则方式有如下")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("match_mapping_type")]),s._v(" 对"),n("code",[s._v("Elasticsearch")]),s._v("中检测到的数据类型进行操作，参考上方图表")]),s._v(" "),n("li",[n("code",[s._v("match")]),s._v("与"),n("code",[s._v("unmatch")]),s._v(" 可以使用模式匹配字段名")]),s._v(" "),n("li",[n("code",[s._v("path_match")]),s._v("与"),n("code",[s._v("path_unmatch")]),s._v(" 对字段的完整虚线路径进行操作")]),s._v(" "),n("li",[s._v("如果动态模版没有定义"),n("code",[s._v("march_mapping_type")]),s._v("、"),n("code",[s._v("match")]),s._v("或"),n("code",[s._v("path_match")]),s._v("，那么模版不会匹配任何一个字段。但是"),n("code",[s._v("_bulk")]),s._v("请求时可以通过模版名引用模版")])]),s._v(" "),n("p",[s._v("也可以使用"),n("code",[s._v("{name}")]),s._v("和"),n("code",[s._v("{dynamic_type}")]),s._v("模版变量作为占位符，比如后文中使用占位符实现分词器的指定等")]),s._v(" "),n("p",[s._v("动态模版的定义是对象数组")]),s._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"dynamic_templates"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"my_template_name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("#"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n      ... 匹配条件 ...#"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token property"}},[s._v('"mapping"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("..."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("#"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  ...\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("ol",[n("li",[s._v("自定义模版名称，可以是任意的字符串")]),s._v(" "),n("li",[s._v("模版的使用匹配条件可以是："),n("code",[s._v("match_mapping_type")]),s._v(","),n("code",[s._v("match")]),s._v(","),n("code",[s._v("match_pattern")]),s._v(","),n("code",[s._v("unmatch")]),s._v(","),n("code",[s._v("path_match")]),s._v(","),n("code",[s._v("path_unmatch")])]),s._v(" "),n("li",[s._v("匹配字段应该使用的索引映射")])]),s._v(" "),n("p",[s._v("通过上面的 学习，我们知道了动态模版的定义，既然定义好了就该有验证，毕竟定义好的模版能不能用，是否定义的正确性还是需要验证的")]),s._v(" "),n("h1",{attrs:{id:"验证动态模版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#验证动态模版"}},[s._v("#")]),s._v(" 验证动态模版")]),s._v(" "),n("p",[s._v("如果定义的模版包含无效的映射片段则会返回错误。在"),n("code",[s._v("index")]),s._v("操作时应用动态模版进行验证，但是大多数情况下在动态模版更新的时候会进行验证。提供无效的映射片段可能造成在更新或者某些条件下动态模版的验证失败，比如：")]),s._v(" "),n("ul",[n("li",[s._v("如果没有指定"),n("code",[s._v("match_mapping_type")]),s._v("，但是这个模版提供了最少一个的有效映射，那么这个映射片段是有效的。但是如果将与模版匹配的字段映射为其他类型，则在index时返回验证错误。例如：配置一个动态模版，不包含"),n("code",[s._v("match_mapping_type")]),s._v("，这样就是一个有效的字符串类型，但是如果有一个字段匹配动态模版时被匹配为"),n("code",[s._v("long")]),s._v("，那么在"),n("code",[s._v("index")]),s._v("时将返回验证错误。建议就是将"),n("code",[s._v("match_mapping_type")]),s._v("配置为预期的"),n("code",[s._v("JSON")]),s._v("类型（参考开头的映射关系表）或者在"),n("code",[s._v("mapping")]),s._v("中配置好所需的类型")]),s._v(" "),n("li",[s._v("如果我们在"),n("code",[s._v("mapping")]),s._v("的片段中使用了"),n("code",[s._v("{name}")]),s._v("占位符，那么在动态模版的更新时是跳过验证的。这是因为当时的字段名还是不知道的，所以在"),n("code",[s._v("index")]),s._v("时进行验证")])]),s._v(" "),n("p",[s._v("如果有多个模版同时匹配，按照顺序匹配规则处理，第一个匹配的模版具有最高的优先级；当通过"),n("code",[s._v("update mapping API")]),s._v("更新动态模版时，所有的现有模版将会被覆盖，这就允许在最初的创建动态模版之后可以重新排序或者删除它们")]),s._v(" "),n("h1",{attrs:{id:"动态模版中映射运行时字段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动态模版中映射运行时字段"}},[s._v("#")]),s._v(" 动态模版中映射运行时字段")]),s._v(" "),n("p",[s._v("在上一节中我们的本小节内容例子就是使用的这个，有兴趣的可以回过头再看一眼，链接放到文章开头了")]),s._v(" "),n("p",[s._v("如果我们想"),n("code",[s._v("Elasticsearch")]),s._v("将某一种类型的新字段动态映射为运行时字段，那么我们可以通过设置"),n("code",[s._v('"dynamic":"runtime"')]),s._v(",这些字段不会被编入索引，并且在查询时是从"),n("code",[s._v("_source")]),s._v("加载")]),s._v(" "),n("p",[s._v("或者我们使用默认的动态映射规则，然后创建动态模版，并将特定的字段映射为运行时字段。我们需要在"),n("code",[s._v("index mapping")]),s._v("中设置"),n("code",[s._v('"dynamic:"true",')]),s._v("然后创建一个动态模版，并将某种类型的新字段映射为运行时字段")]),s._v(" "),n("p",[s._v("举个例子，假设我们有一组数据，其中每个字段都是"),n("code",[s._v("_ip")]),s._v("开头的，根据动态映射规则，"),n("code",[s._v("Elasticsearch")]),s._v("会根据数值检测到的任何的字符串映射为"),n("code",[s._v("float")]),s._v("或者"),n("code",[s._v("long")]),s._v("，此时我们就可以创建一个动态模版，将这个新字符串映射为"),n("code",[s._v("ip")]),s._v("类型的运行时字段")]),s._v(" "),n("p",[s._v("下面是我们的一个例子，大概意思就是当"),n("code",[s._v("Elasticsearch")]),s._v("使用匹配模式是"),n("code",[s._v("ip*")]),s._v("的新字段时，它会将这些字段映射为"),n("code",[s._v("ip")]),s._v("类型的运行时字段。因为这些字段不是动态映射的，所以我们可以使用"),n("code",[s._v('"dynamic":"true"')]),s._v("或者"),n("code",[s._v('"dynamic":"runtime"')]),s._v("结合使用")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-001/\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "strings_as_ip": {\n          "match_mapping_type": "string",\n          "match": "ip*",\n          "runtime": {\n            "type": "ip"\n          }\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("结合"),n("code",[s._v('"dynamic":"true"')]),s._v("或者"),n("code",[s._v('"dynamic":"runtime"')]),s._v("使用")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-001/\n{\n  "mappings": {\n    "dynamic":"runtime",\n    "dynamic_templates": [\n      {\n        "strings_as_ip": {\n          "match_mapping_type": "string",\n          "match": "ip*",\n          "runtime": {\n            "type": "ip"\n          }\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("p",[s._v("上面的语句，我们会把符合匹配模式"),n("code",[s._v("ip*")]),s._v("的新字段映射为运行时字段，但是因为我们设置"),n("code",[s._v('"dynamic":"runtime"')]),s._v(",所以后面的新字段我们都会设置为运行时字段，也就是下面这个语句，其中"),n("code",[s._v("ip_req")]),s._v(","),n("code",[s._v("ip_res")]),s._v(",符合动态模版"),n("code",[s._v("dynamic_templates")]),s._v("的匹配规则"),n("code",[s._v("ip*")]),s._v("，而"),n("code",[s._v("my_ip")]),s._v("使用索引开头设置的"),n("code",[s._v('"dynamic":"runtime"')]),s._v("也会加入到运行时字段")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-001/_doc/1\n{\n  "ip_req":"127.0.0.1",\n  "ip_res":"127.0.0.1",\n  "my_ip":"locahost"\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("此时我们查看索引情况如下")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "my-dynamic-template-001" : {\n    "mappings" : {\n      "dynamic" : "runtime",\n      "dynamic_templates" : [\n        {\n          "strings_as_ip" : {\n            "match" : "ip*",\n            "match_mapping_type" : "string",\n            "runtime" : {\n              "type" : "ip"\n            }\n          }\n        }\n      ],\n      "runtime" : {\n        "ip_req" : {\n          "type" : "ip"\n        },\n        "ip_res" : {\n          "type" : "ip"\n        },\n        "my_ip" : {\n          "type" : "keyword"\n        }\n      }\n    }\n  }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br")])]),n("p",[s._v("上面就是一个简单的使用，其中")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("match_mapping_type")]),s._v(" 是"),n("code",[s._v("string")]),s._v("，也就是字段的值是字符串")]),s._v(" "),n("li",[n("code",[s._v("match")]),s._v(" 是"),n("code",[s._v("ip*")]),s._v(" 即该字段名为"),n("code",[s._v("ip")]),s._v("开头的")]),s._v(" "),n("li",[n("code",[s._v("runtime")]),s._v(" 定义被映射的字段类型，在上面例子中，被映射为"),n("code",[s._v("runtime")]),s._v("，类型为"),n("code",[s._v("ip")])])]),s._v(" "),n("h1",{attrs:{id:"match-mapping-type"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#match-mapping-type"}},[s._v("#")]),s._v(" match_mapping_type")]),s._v(" "),n("p",[n("code",[s._v("match_mapping_type")]),s._v(" 是"),n("code",[s._v("JSON")]),s._v("解析器检测到的数据类型。因为"),n("code",[s._v("JSON")]),s._v("不区分"),n("code",[s._v("long")]),s._v("和"),n("code",[s._v("integer")]),s._v("，也不区分"),n("code",[s._v("double")]),s._v("和"),n("code",[s._v("float")]),s._v("，所以解析时"),n("code",[s._v("double")]),s._v("和"),n("code",[s._v("float")]),s._v("都会被认为是"),n("code",[s._v("double")]),s._v("，"),n("code",[s._v("integer")]),s._v("与"),n("code",[s._v("long")]),s._v("都会被认为是"),n("code",[s._v("long")])]),s._v(" "),n("blockquote",[n("p",[s._v("注意：当使用动态映射的时候，ELasticsearch将始终选择更广泛的数据类型，但是有个例外是"),n("code",[s._v("float")]),s._v("类型，它的需要的存储空间少于"),n("code",[s._v("double")]),s._v("，并且对于大多数的应用程序来说足够准确。但是运行时字段不支持"),n("code",[s._v("float")]),s._v("类型，所以这就是"),n("code",[s._v('"dynamic":"runtime"')]),s._v("使用"),n("code",[s._v("double")]),s._v("的原因")])]),s._v(" "),n("p",[s._v("Elasticsearch 会自动检测数据类型，检测规则就是文章开头的那个表格内容，并且我们还可以使用"),n("code",[s._v("match_mapping_type")]),s._v("中使用通配符"),n("code",[s._v("*")]),s._v("来匹配所有的数据类型")]),s._v(" "),n("p",[s._v("举个例子，如果我们想把整数字段映射为"),n("code",[s._v("integer")]),s._v("而不是"),n("code",[s._v("long")]),s._v("类型，字符串字段匹配为"),n("code",[s._v("text")]),s._v("和"),n("code",[s._v("keyword")]),s._v("类型，我们可以使用如下模版")]),s._v(" "),n("ul",[n("li",[s._v("创建一个模版")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-002\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "integers": {\n          "match_mapping_type": "long",\n          "mapping": {\n            "type": "integer"\n          }\n        }\n      },\n      {\n        "strings": {\n          "match_mapping_type": "string",\n          "mapping": {\n            "type": "text",\n            "fields": {\n              "raw": {\n                "type":  "keyword",\n                "ignore_above": 256\n              }\n            }\n          }\n        }\n      }\n    ]\n  }\n}\n\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("插入一条测试数据")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-002/_doc/1\n{\n  "my_integer": 5, \n  "my_string": "Some string" \n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("查看生成的"),n("code",[s._v("mapping")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("GET my-dynamic-template-002/_mapping\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("返回结果如下，"),n("code",[s._v("my_integer")]),s._v("会被映射为"),n("code",[s._v("integer")]),s._v("，"),n("code",[s._v("my_string")]),s._v("会被映射为"),n("code",[s._v("text")]),s._v("和"),n("code",[s._v("keyword")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "my-dynamic-template-002" : {\n    "mappings" : {\n      "dynamic_templates" : [\n        {\n          "integers" : {\n            "match_mapping_type" : "long",\n            "mapping" : {\n              "type" : "integer"\n            }\n          }\n        },\n        {\n          "strings" : {\n            "match_mapping_type" : "string",\n            "mapping" : {\n              "fields" : {\n                "raw" : {\n                  "ignore_above" : 256,\n                  "type" : "keyword"\n                }\n              },\n              "type" : "text"\n            }\n          }\n        }\n      ],\n      "properties" : {\n        "my_integer" : {\n          "type" : "integer"\n        },\n        "my_string" : {\n          "type" : "text",\n          "fields" : {\n            "raw" : {\n              "type" : "keyword",\n              "ignore_above" : 256\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br")])])])]),s._v(" "),n("h1",{attrs:{id:"match与unmatch"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#match与unmatch"}},[s._v("#")]),s._v(" match与unmatch")]),s._v(" "),n("p",[n("code",[s._v("match")]),s._v(" 使用模式匹配字段名称，"),n("code",[s._v("unmatch")]),s._v(" 使用模式排除匹配字段")]),s._v(" "),n("p",[n("code",[s._v("match_pattern")]),s._v("可以通过设置此参数值调整"),n("code",[s._v("match")]),s._v("参数的行为，使"),n("code",[s._v("match")]),s._v("参数支持与字段名匹配的完整"),n("code",[s._v("Java")]),s._v("正则表达式来替代简单的通配符，如下")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('  "match_pattern": "regex",\n  "match": "^profit_\\d+$"\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("如下示例，我们匹配名称以"),n("code",[s._v("long_")]),s._v("开头的所有字符串字段，排出以"),n("code",[s._v("_text")]),s._v("结尾的字符串字段，并将它们映射为"),n("code",[s._v("long")]),s._v("类型的字段")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\nPUT my-dynamic-template-003\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "longs_as_strings": {\n          "match_mapping_type": "string",\n          "match":   "long_*",\n          "unmatch": "*_text",\n          "mapping": {\n            "type": "long"\n          }\n        }\n      }\n    ]\n  }\n}\n\nPUT my-dynamic-template-003/_doc/1\n{\n  "long_num": "5", \n  "long_text": "foo" \n}\n\nGET my-dynamic-template-003/_mapping\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])]),n("p",[s._v("在上面例子中，"),n("code",[s._v("long_num")]),s._v("被映射为"),n("code",[s._v("long")]),s._v("类型的字段，这是因为"),n("code",[s._v("match_mapping_type")]),s._v("为"),n("code",[s._v("string")]),s._v("类型，并且是"),n("code",[s._v("long_")]),s._v("开头的。"),n("code",[s._v("long_text")]),s._v("虽然是"),n("code",[s._v("long_")]),s._v("开头的，但是也是"),n("code",[s._v("_text")]),s._v("结尾的，符合"),n("code",[s._v("unmatch")]),s._v("条件，这样的话"),n("code",[s._v("long_text")]),s._v("就按照默认规则"),n("code",[s._v("string")]),s._v("进行映射，生成"),n("code",[s._v("text")]),s._v("及"),n("code",[s._v("keyword")]),s._v("字段")]),s._v(" "),n("h1",{attrs:{id:"path-match与path-unmatch"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#path-match与path-unmatch"}},[s._v("#")]),s._v(" path_match与path_unmatch")]),s._v(" "),n("p",[n("code",[s._v("path_match")]),s._v("和"),n("code",[s._v("path_unmatch")]),s._v("与"),n("code",[s._v("match")]),s._v("和"),n("code",[s._v("unmatch")]),s._v("原理类似，但是是对字段的完整虚线路径进行匹配，而不仅仅是最终名称，例如"),n("code",[s._v("some_object.*.some_field")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-004\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "full_name": {\n          "path_match":   "name.*",\n          "path_unmatch": "*.middle",\n          "mapping": {\n            "type":       "text",\n            "copy_to":    "full_name"\n          }\n        }\n      }\n    ]\n  }\n}\n\nPUT my-dynamic-template-004/_doc/1\n{\n  "name": {\n    "first":  "John",\n    "middle": "Winston",\n    "last":   "Lennon"\n  }\n}\n\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("p",[s._v("如上所示，凡是"),n("code",[s._v("name")]),s._v("下的任何字段，除了以"),n("code",[s._v("middle")]),s._v("结尾的字段除外，都会被映射为"),n("code",[s._v("text")]),s._v("类型，并且"),n("code",[s._v("copy_to")]),s._v("带有"),n("code",[s._v("full_name")])]),s._v(" "),n("p",[s._v("执行如下命令查看")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("GET my-dynamic-template-004/_mapping\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("显示结果如下")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "my-dynamic-template-004" : {\n    "mappings" : {\n      "dynamic_templates" : [\n        {\n          "full_name" : {\n            "path_match" : "name.*",\n            "path_unmatch" : "*.middle",\n            "mapping" : {\n              "copy_to" : "full_name",\n              "type" : "text"\n            }\n          }\n        }\n      ],\n      "properties" : {\n        "full_name" : {\n          "type" : "text",\n          "fields" : {\n            "keyword" : {\n              "type" : "keyword",\n              "ignore_above" : 256\n            }\n          }\n        },\n        "name" : {\n          "properties" : {\n            "first" : {\n              "type" : "text",\n              "copy_to" : [\n                "full_name"\n              ]\n            },\n            "last" : {\n              "type" : "text",\n              "copy_to" : [\n                "full_name"\n              ]\n            },\n            "middle" : {\n              "type" : "text",\n              "fields" : {\n                "keyword" : {\n                  "type" : "keyword",\n                  "ignore_above" : 256\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br")])]),n("p",[s._v("从上面的结果可知，我们能够看出来，"),n("code",[s._v("name")]),s._v("之下的"),n("code",[s._v("middle")]),s._v("没有"),n("code",[s._v("copy_to")]),s._v("，它的映射按照默认的"),n("code",[s._v("string")]),s._v("映射规则，生成"),n("code",[s._v("text")]),s._v("以及"),n("code",[s._v("keyword")])]),s._v(" "),n("p",[s._v("需要注意的是，除了"),n("code",[s._v("leaf")]),s._v("字段外，"),n("code",[s._v("path_match")]),s._v("与"),n("code",[s._v("path_unmatch")]),s._v("参数匹配对象路径，如下对文档索引将产生错误，因为"),n("code",[s._v("name.title")]),s._v("不能映射为文本类型")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-004/_doc/2\n{\n  "name": {\n    "first":  "Paul",\n    "last":   "McCartney",\n    "title": {\n      "value": "Sir",\n      "category": "order of chivalry"\n    }\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("报错如下")]),s._v(" "),n("div",{staticClass:"language-text' line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "error" : {\n    "root_cause" : [\n      {\n        "type" : "mapper_parsing_exception",\n        "reason" : "failed to parse field [name.title] of type [text] in document with id \'2\'. Preview of field\'s value: \'{category=order of chivalry, value=Sir}\'"\n      }\n    ],\n    "type" : "mapper_parsing_exception",\n    "reason" : "failed to parse field [name.title] of type [text] in document with id \'2\'. Preview of field\'s value: \'{category=order of chivalry, value=Sir}\'",\n    "caused_by" : {\n      "type" : "illegal_state_exception",\n      "reason" : "Can\'t get text on a START_OBJECT at 5:14"\n    }\n  },\n  "status" : 400\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("h1",{attrs:{id:"template-variables-模版变量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#template-variables-模版变量"}},[s._v("#")]),s._v(" template variables （模版变量）")]),s._v(" "),n("p",[n("code",[s._v("{name}")]),s._v("和"),n("code",[s._v("{dynamic_type}")]),s._v("占位符在映射中被替换为字段名称和检测到的动态类型")]),s._v(" "),n("p",[s._v("如下示例，将所有的字符串字段使用与字段同名的分析器，并禁用所有不是字符串字段的"),n("code",[s._v("doc_values")])]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('\nPUT my-dynamic-template-005\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "named_analyzers": {\n          "match_mapping_type": "string",\n          "match": "*",\n          "mapping": {\n            "type": "text",\n            "analyzer": "{name}"\n          }\n        }\n      },\n      {\n        "no_doc_values": {\n          "match_mapping_type":"*",\n          "mapping": {\n            "type": "{dynamic_type}",\n            "doc_values": false\n          }\n        }\n      }\n    ]\n  }\n}\n\nPUT my-dynamic-template-005/_doc/1\n{\n  "english": "Some English text", \n  "count":   5 \n}\nGET my-dynamic-template-005/_mapping\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("p",[s._v("在上面例子中，"),n("code",[s._v("{name}")]),s._v("被替换为"),n("code",[s._v("field name")]),s._v("，而"),n("code",[s._v("{dynamic_type}")]),s._v("被替换为有"),n("code",[s._v("JSON")]),s._v("解析器检测到的数据类型")]),s._v(" "),n("p",[n("code",[s._v("english")]),s._v("字段分析器设置为"),n("code",[s._v("english")]),s._v("，而"),n("code",[s._v("count")]),s._v("被检测为"),n("code",[s._v("long")]),s._v("类型，并且"),n("code",[s._v("doc_values")]),s._v("设置为"),n("code",[s._v("false")])]),s._v(" "),n("h1",{attrs:{id:"动态模版的例子"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#动态模版的例子"}},[s._v("#")]),s._v(" 动态模版的例子")]),s._v(" "),n("h2",{attrs:{id:"结构化搜索"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#结构化搜索"}},[s._v("#")]),s._v(" 结构化搜索")]),s._v(" "),n("p",[s._v("当我们设置"),n("code",[s._v('"dynamic":"true"')]),s._v("时，Elasticsearch会将字符串字段映射为"),n("code",[s._v("text")]),s._v("类型，并带有一个"),n("code",[s._v("keyword")]),s._v("类型的子字段，如果我们只是结构化的搜索，对全文检索不需要，那么我们就可以让Elasticsearch映射为"),n("code",[s._v("keyword")]),s._v("字段，但是这样做的话，必须搜索与索引完全相同的值才能搜索这些字段，也就是精确匹配")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-006\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "strings_as_keywords": {\n          "match_mapping_type": "string",\n          "mapping": {\n            "type": "keyword"\n          }\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h2",{attrs:{id:"字符串的纯文本映射"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#字符串的纯文本映射"}},[s._v("#")]),s._v(" 字符串的纯文本映射")]),s._v(" "),n("p",[s._v("与上面结构化搜索相反，如果我们只关心全文检索，并且不会对字段进行聚合、排序和精确查找，那么我们让Elasticsearch将字符串映射为"),n("code",[s._v("text")]),s._v("类型")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-007\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "strings_as_text": {\n          "match_mapping_type": "string",\n          "mapping": {\n            "type": "text"\n          }\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("对于最近版本增加的运行时字段，我们呢还可以创建一个动态模版，将字符串映射为运行时的"),n("code",[s._v("keyword")]),s._v("类型，虽说该字段不会被索引，但是它们的值是存在"),n("code",[s._v("_source")]),s._v("中，并且可以用于搜索、聚合、过滤和排序")]),s._v(" "),n("p",[s._v("例如如下示例，将创建一个动态模版，将"),n("code",[s._v("string")]),s._v("字段映射为"),n("code",[s._v("keyword")]),s._v("运行时字段，虽然"),n("code",[s._v("runtime")]),s._v("定义是空的，但是Elasticsearch会使用文章开头的匹配规则添加，任何一个未通过时间或者数字检测的字符串都会被映射为"),n("code",[s._v("keyword")]),s._v("类型")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-008\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "strings_as_keywords": {\n          "match_mapping_type": "string",\n          "runtime": {}\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("此时我们索引一个文档")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-008/_doc/1\n{\n  "english": "Some English text",\n  "count":   5\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("查看映射关系时，可以看到"),n("code",[s._v("english")]),s._v("被映射为"),n("code",[s._v("keyword")]),s._v("类型的运行时字段")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("GET my-dynamic-template-008/_mapping\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('{\n  "my-dynamic-template-008" : {\n    "mappings" : {\n      "dynamic_templates" : [\n        {\n          "strings_as_keywords" : {\n            "match_mapping_type" : "string",\n            "runtime" : { }\n          }\n        }\n      ],\n      "runtime" : {\n        "english" : {\n          "type" : "keyword"\n        }\n      },\n      "properties" : {\n        "count" : {\n          "type" : "long"\n        }\n      }\n    }\n  }\n}\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("h2",{attrs:{id:"disable-norms"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#disable-norms"}},[s._v("#")]),s._v(" Disable norms")]),s._v(" "),n("p",[s._v("如果我们不按照评分进行排序，那么可以禁用索引中的评分因子以节省空间")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-009\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "strings_as_keywords": {\n          "match_mapping_type": "string",\n          "mapping": {\n            "type": "text",\n            "norms": false,\n            "fields": {\n              "keyword": {\n                "type": "keyword",\n                "ignore_above": 256\n              }\n            }\n          }\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("上面模版中出现的"),n("code",[s._v("keyword")]),s._v("的关键字字段是与动态映射的默认规则一致的，如果我们不需要可以按照上面的例子将其删除")]),s._v(" "),n("h2",{attrs:{id:"时间序列"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#时间序列"}},[s._v("#")]),s._v(" 时间序列")]),s._v(" "),n("p",[s._v("在使用Elasticsearch进行时间序列的分析时，通常会有很多的数字字段，但是这些数字字段一般不会进行过滤通常都是进行聚合。在这种情况下我们可以禁用这些字段的索引以节省磁盘空间，或许也可能获得一些索引的速度")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT my-dynamic-template-010\n{\n  "mappings": {\n    "dynamic_templates": [\n      {\n        "unindexed_longs": {\n          "match_mapping_type": "long",\n          "mapping": {\n            "type": "long",\n            "index": false\n          }\n        }\n      },\n      {\n        "unindexed_doubles": {\n          "match_mapping_type": "double",\n          "mapping": {\n            "type": "float", \n            "index": false\n          }\n        }\n      }\n    ]\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br")])]),n("p",[s._v("与默认的动态规则一样，"),n("code",[s._v("double")]),s._v("被映射为"),n("code",[s._v("float")]),s._v("，因为他可以满足绝大多数的请求。并且只需要一半的磁盘空间")]),s._v(" "),n("h1",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),n("p",[s._v("好了关于动态模版的知识到这就结束了，从开始介绍什么是动态模版，其次是动态模版如何使用以及最后的动态模版的常用示例，那么你掌握了多少呢，快去尝试一下吧，下一篇预告《为时间序列索引定义索引生命周期策略ILM》敬请期待")])])}),[],!1,null,null,null);n.default=t.exports}}]);