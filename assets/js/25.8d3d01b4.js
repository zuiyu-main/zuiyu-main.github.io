(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{432:function(n,e,t){"use strict";t.r(e);var i=t(2),a=Object(i.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"本文环境"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本文环境"}},[n._v("#")]),n._v(" 本文环境")]),n._v(" "),e("p",[n._v("elasticsearch 7.4.0\nik 7.4.0\npinyin 7.4.0")]),n._v(" "),e("h1",{attrs:{id:"安装ik分词器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装ik分词器"}},[n._v("#")]),n._v(" 安装ik分词器")]),n._v(" "),e("p",[n._v("https://github.com/medcl/elasticsearch-analysis-ik/releases/tag/v7.4.0")]),n._v(" "),e("ul",[e("li",[e("p",[n._v("下载 elasticsearch-analysis-ik-7.4.0.zip")])]),n._v(" "),e("li",[e("p",[n._v("在es对应的plugins文件夹下面新建ik文件夹")])]),n._v(" "),e("li",[e("p",[n._v("解压zip到ik文件夹 unzip elasticsearch-analysis-ik-7.4.0.zip -d plugins/ik")])])]),n._v(" "),e("h1",{attrs:{id:"安装pinyin分词器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装pinyin分词器"}},[n._v("#")]),n._v(" 安装pinyin分词器")]),n._v(" "),e("p",[n._v("https://github.com/medcl/elasticsearch-analysis-pinyin/releases/tag/v7.4.0")]),n._v(" "),e("ul",[e("li",[e("p",[n._v("下载 elasticsearch-analysis-pinyin-7.4.0.zip")])]),n._v(" "),e("li",[e("p",[n._v("在es对应的plugins中新建pinyin文件夹")])]),n._v(" "),e("li",[e("p",[n._v("解压压缩包到pinyin文件夹 unzip elasticsearch-analysis-pinyin-7.4.0.zip -d plugins/pinyin")])])]),n._v(" "),e("h1",{attrs:{id:"本demo搭建脚本参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本demo搭建脚本参考"}},[n._v("#")]),n._v(" 本demo搭建脚本参考")]),n._v(" "),e("p",[n._v("如果启动不成功，修改es映射文件夹路径配置，保留一个plugins的映射即可，本地的plugins里面包含上面解压的两个分词器")]),n._v(" "),e("p",[n._v('version: \'2.2\'\nservices:\ncerebro:\nimage: lmenezes/cerebro:0.8.3\ncontainer_name: cerebro\nports:\n- "9000:9000"\ncommand:\n- -Dhosts.0.host=http://elasticsearch:9200\nnetworks:\n- es74net\nkibana:\nimage: docker.elastic.co/kibana/kibana:7.4.0\ncontainer_name: kibana74\nenvironment:\n- I18N_LOCALE=zh-CN\n- XPACK_GRAPH_ENABLED=true\n- TIMELION_ENABLED=true\n- XPACK_MONITORING_COLLECTION_ENABLED="true"\nports:\n- "5601:5601"\nnetworks:\n- es74net\nelasticsearch:\nimage: elasticsearch:7.4.0\ncontainer_name: es74\nenvironment:\n- cluster.name=docker-cluster\n- node.name=es74\n- bootstrap.memory_lock=true\n- "ES_JAVA_OPTS=-Xms512m -Xmx512m"\n- discovery.seed_hosts=es74\n- cluster.initial_master_nodes=es74\n- path.repo=[\'my_backup_location\']\nulimits:\nmemlock:\nsoft: -1\nhard: -1\nvolumes:\n- es74data1:/usr/share/elasticsearch/data\n- my_backup_locaton:/usr/share/elasticsearch/my_backup_location\n- ./plugins:/usr/share/elasticsearch/plugins\nports:\n- 9200:9200\n- 9300:9300\nnetworks:\n- es74net')]),n._v(" "),e("p",[n._v("volumes:\nes74data1:\ndriver: local\nmy_backup_locaton:\ndriver: local")]),n._v(" "),e("p",[n._v("networks:\nes74net:\ndriver: bridge")]),n._v(" "),e("h1",{attrs:{id:"创建分词器配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建分词器配置"}},[n._v("#")]),n._v(" 创建分词器配置")]),n._v(" "),e("p",[n._v('PUT index\n{\n"settings" : {\n"analysis" : {\n"analyzer" : {\n"ik_smart_pinyin" : {\n"tokenizer" : "ik_smart",\n"filter" : "pinyin_first_letter_and_full_pinyin_filter"\n},\n"ik_max_pinyin" : {\n"tokenizer" : "ik_max_word",\n"filter" : "pinyin_first_letter_and_full_pinyin_filter"\n}\n},\n"filter" : {\n"pinyin_first_letter_and_full_pinyin_filter" : {\n"type" : "pinyin",\n"keep_separate_first_letter" : false,\n"keep_full_pinyin" : true,\n"keep_original" : true,\n"limit_first_letter_length" : 16,\n"lowercase" : true,\n"remove_duplicated_term" : true\n}\n}\n}\n}\n}')]),n._v(" "),e("ul",[e("li",[n._v('curl 命令\ncurl -XPUT "http://elasticsearch:9200/index" -H \'Content-Type: application/json\' -d\'{    "settings" : {        "analysis" : {            "analyzer" : {                "ik_smart_pinyin" : {                    "tokenizer" : "ik_smart",                    "filter" : "pinyin_first_letter_and_full_pinyin_filter"                },                "ik_max_pinyin" : {                    "tokenizer" : "ik_max_word",                    "filter" : "pinyin_first_letter_and_full_pinyin_filter"                }            },            "filter" : {                "pinyin_first_letter_and_full_pinyin_filter" : {                    "type" : "pinyin",                    "keep_separate_first_letter" : false,                    "keep_full_pinyin" : true,                    "keep_original" : true,                    "limit_first_letter_length" : 16,                    "lowercase" : true,                    "remove_duplicated_term" : true                }            }        }    }}\'')])]),n._v(" "),e("h1",{attrs:{id:"添加mappings"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加mappings"}},[n._v("#")]),n._v(" 添加mappings")]),n._v(" "),e("p",[n._v('PUT index/_mapping/\n{\n"properties": {\n"content": {\n"type": "text",\n"analyzer": "ik_smart_pinyin"\n}\n}\n}')]),n._v(" "),e("ul",[e("li",[n._v('curl 命令\ncurl -XPUT "http://elasticsearch:9200/index/_mapping/" -H \'Content-Type: application/json\' -d\'{  "properties": {    "content": {      "type": "text",      "analyzer": "ik_smart_pinyin"    }  }}\'')])]),n._v(" "),e("h1",{attrs:{id:"添加测试数据"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加测试数据"}},[n._v("#")]),n._v(" 添加测试数据")]),n._v(" "),e("p",[n._v('POST /index/_create/1\n{"content":"我是刘德华"}')]),n._v(" "),e("p",[n._v('POST /index/_create/2\n{"content":"我是郭富城"}')]),n._v(" "),e("p",[n._v('POST /index/_create/3\n{"content":"我是明星"}')]),n._v(" "),e("p",[n._v('POST /index/_create/4\n{"content":"我是林晨"}')]),n._v(" "),e("ul",[e("li",[n._v("curl 命令")])]),n._v(" "),e("p",[n._v('curl -XPOST "http://elasticsearch:9200/index/_create/1" -H \'Content-Type: application/json\' -d\'{"content":"我是刘德华"}\'')]),n._v(" "),e("h1",{attrs:{id:"搜索测试"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搜索测试"}},[n._v("#")]),n._v(" 搜索测试")]),n._v(" "),e("p",[n._v("此时使用汉字的拼音，首字母，汉字皆可检索到")]),n._v(" "),e("p",[n._v('GET index/_search\n{\n"query": {\n"bool": {\n"must": [\n{\n"match": {\n"content": "liu"\n}\n}\n],\n"must_not": [],\n"should": []\n}\n},\n"from": 0,\n"size": 10,\n"sort": [],\n"aggs": {}\n}')]),n._v(" "),e("ul",[e("li",[n._v("curl 命令")])]),n._v(" "),e("p",[n._v('curl -XGET "http://elasticsearch:9200/index/_search" -H \'Content-Type: application/json\' -d\'{    "query": {        "bool": {            "must": [                {                    "match": {                        "content": "w"                    }                }            ],            "must_not": [],            "should": []        }    },    "from": 0,    "size": 10,    "sort": [],    "aggs": {}}\'')]),n._v(" "),e("h1",{attrs:{id:"测试分词"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#测试分词"}},[n._v("#")]),n._v(" 测试分词")]),n._v(" "),e("p",[n._v("POST index/_analyze")]),n._v(" "),e("p",[n._v("{")]),n._v(" "),e("p",[n._v('"analyzer":"ik_smart_pinyin",')]),n._v(" "),e("p",[n._v('"text":"我是Java程序员，我很牛逼"')]),n._v(" "),e("p",[n._v("}")])])}),[],!1,null,null,null);e.default=a.exports}}]);