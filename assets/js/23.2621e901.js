(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{433:function(s,n,e){"use strict";e.r(n);var a=e(2),t=Object(a.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[s._v("#")]),s._v(" 简介")]),s._v(" "),n("p",[s._v("今天来说一说"),n("strong",[s._v("Elasticsearch")]),s._v(" 的重新评分，即在检索出来一次结果的基础上在进行检索提升数据排序效果，但是仅对查询或者post_filter阶段返回的前多少条进行二次查询。在每个分片上进行二次检索的文档数量时可以通过"),n("code",[s._v("window_size")]),s._v("控制的，该参数默认"),n("code",[s._v("10")]),s._v("。")]),s._v(" "),n("p",[s._v("默认情况下，原来的查询语句与二次查询的份数将线性组合以生成文档的最终得分"),n("code",[s._v("_score")]),s._v(",原始查询语句的权重通过"),n("code",[s._v("query_weight")]),s._v("控制，重新二次查询的权重通过"),n("code",[s._v("rescore_query_weight")]),s._v("控制，他们默认都是"),n("code",[s._v("1")]),s._v("。")]),s._v(" "),n("p",[s._v("在Elasticsearch中，"),n("code",[s._v("rescore_query")]),s._v("是一种用于改进搜索结果排序的查询。它可以在原始查询结果的基础上重新计算得分，并重新排序搜索结果。")]),s._v(" "),n("p",[n("code",[s._v("rescore_query")]),s._v("通常用于在搜索过程的后期阶段对搜索结果进行优化。它可以根据特定的需求和业务规则，对原始查询结果进行二次排序，以提高最相关的文档的排名。")]),s._v(" "),n("p",[n("code",[s._v("rescore_query")]),s._v("可以在分布式搜索中非常有用，因为它仅在原始查询的结果上执行计算，而不需要重新执行整个查询过程。这可以提高搜索速度并减轻系统负载。")]),s._v(" "),n("p",[s._v("通过使用"),n("code",[s._v("rescore_query")]),s._v("，可以根据不同的评分算法、过滤器或其他上下文信息，对搜索结果进行个性化的定制排序。它可以根据文档的属性、时间戳、地理位置等进行排序，以获得更加准确和有用的搜索结果。")]),s._v(" "),n("p",[s._v("总而言之，"),n("code",[s._v("rescore_query")]),s._v("是一种用于改进搜索结果排序的查询，可以根据不同的规则和需求重新计算得分并重新排序搜索结果，以提高搜索准确性和实用性。")]),s._v(" "),n("h1",{attrs:{id:"实战"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[s._v("#")]),s._v(" 实战")]),s._v(" "),n("h2",{attrs:{id:"搭建es环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#搭建es环境"}},[s._v("#")]),s._v(" 搭建ES环境")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('version: \'3.8\'\nservices:\n  cerebro:\n    image: lmenezes/cerebro:0.8.3\n    container_name: cerebro\n    ports:\n     - "9000:9000"\n    command:\n     - -Dhosts.0.host=http://eshot:9200\n    networks:\n     - elastic\n  kibana:\n    image: docker.elastic.co/kibana/kibana:8.1.3\n    container_name: kibana\n    environment:\n      - I18N_LOCALE=zh-CN\n      - XPACK_GRAPH_ENABLED=true\n      - TIMELION_ENABLED=true\n      - XPACK_MONITORING_COLLECTION_ENABLED="true"\n      - ELASTICSEARCH_HOSTS=http://eshot:9200\n      - server.publicBaseUrl=http://192.168.160.234:5601\n    ports:\n      - "5601:5601"\n    networks:\n      - elastic\n  eshot:\n    image: elasticsearch:8.1.3\n    container_name: eshot\n    environment:\n      - node.name=eshot\n      - cluster.name=es-docker-cluster\n      - discovery.seed_hosts=eshot,eswarm,escold\n      - cluster.initial_master_nodes=eshot,eswarm,escold\n      - bootstrap.memory_lock=true\n      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"\n      - xpack.security.enabled=false\n      - node.attr.node_type=hot\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - D:\\zuiyuftp\\docker\\es8.1\\eshot\\data:/usr/share/elasticsearch/data\n      - D:\\zuiyuftp\\docker\\es8.1\\eshot\\logs:/usr/share/elasticsearch/logs\n      - D:\\zuiyuftp\\docker\\es8.1\\eshot\\plugins:/usr/share/elasticsearch/plugins\n    ports:\n      - 9200:9200\n    networks:\n      - elastic\n  eswarm:\n    image: elasticsearch:8.1.3\n    container_name: eswarm\n    environment:\n      - node.name=eswarm\n      - cluster.name=es-docker-cluster\n      - discovery.seed_hosts=eshot,eswarm,escold\n      - cluster.initial_master_nodes=eshot,eswarm,escold\n      - bootstrap.memory_lock=true\n      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"\n      - xpack.security.enabled=false\n      - node.attr.node_type=warm\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - D:\\zuiyuftp\\docker\\es8.1\\eswarm\\data:/usr/share/elasticsearch/data\n      - D:\\zuiyuftp\\docker\\es8.1\\eswarm\\logs:/usr/share/elasticsearch/logs\n      - D:\\zuiyuftp\\docker\\es8.1\\eshot\\plugins:/usr/share/elasticsearch/plugins\n    networks:\n      - elastic\n  escold:\n    image: elasticsearch:8.1.3\n    container_name: escold\n    environment:\n      - node.name=escold\n      - cluster.name=es-docker-cluster\n      - discovery.seed_hosts=eshot,eswarm,escold\n      - cluster.initial_master_nodes=eshot,eswarm,escold\n      - bootstrap.memory_lock=true\n      - "ES_JAVA_OPTS=-Xms512m -Xmx512m"\n      - xpack.security.enabled=false\n      - node.attr.node_type=cold\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - D:\\zuiyuftp\\docker\\es8.1\\escold\\data:/usr/share/elasticsearch/data\n      - D:\\zuiyuftp\\docker\\es8.1\\escold\\logs:/usr/share/elasticsearch/logs\n      - D:\\zuiyuftp\\docker\\es8.1\\eshot\\plugins:/usr/share/elasticsearch/plugins\n    networks:\n      - elastic\n\n# volumes:\n#   eshotdata:\n#     driver: local\n#   eswarmdata:\n#     driver: local\n#   escolddata:\n#     driver: local\n\nnetworks:\n  elastic:\n    driver: bridge\n\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br")])]),n("h2",{attrs:{id:"创建索引"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#创建索引"}},[s._v("#")]),s._v(" 创建索引")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT /zfc-doc-000006\n{\n  "mappings": {\n    "properties": {\n      "title":{\n        "type": "text",\n        "analyzer": "ik_max_word"\n      },\n      "content": {\n        "type": "text",\n        "analyzer": "ik_max_word"\n      }\n    }\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("h2",{attrs:{id:"添加测试数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加测试数据"}},[s._v("#")]),s._v(" 添加测试数据")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('PUT _bulk\n{"index":{"_index":"zfc-doc-000006","_id":"1"}}\n{"title":"ES实战","content":"ES的实战操作，实战要领，实战经验"}\n{"index":{"_index":"zfc-doc-000006","_id":"2"}}\n{"title":"MySQL实战","content":"MySQL的实战操作"}\n{"index":{"_index":"zfc-doc-000006","_id":"3"}}\n{"title":"MySQL","content":"MySQL一定要会"}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"检索验证"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#检索验证"}},[s._v("#")]),s._v(" 检索验证")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("首先我们还是正常检索一下"),n("code",[s._v("content")]),s._v("字段中包含实战的文档")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('GET zfc-doc-000006/_search\n{\n  "query": {\n    "match": {\n      "content": "实战"\n    }\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("按照我们的预期，因为"),n("code",[s._v("文档1")]),s._v("中包含"),n("code",[s._v("实战")]),s._v("有"),n("code",[s._v("3")]),s._v("次出现，所以"),n("code",[s._v("title")]),s._v("为"),n("code",[s._v("ES实战")]),s._v("的排名靠前，可以看到"),n("code",[s._v("文档1")]),s._v("的算分为"),n("code",[s._v("0.6")]),s._v("，位列第一，输出结果如下")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    "max_score" : 0.667102,\n    "hits" : [\n      {\n        "_index" : "zfc-doc-000006",\n        "_id" : "1",\n        "_score" : 0.667102,\n        "_source" : {\n          "title" : "ES实战",\n          "content" : "ES的实战操作，实战要领，实战经验"\n        }\n      },\n      {\n        "_index" : "zfc-doc-000006",\n        "_id" : "2",\n        "_score" : 0.5442147,\n        "_source" : {\n          "title" : "MySQL实战",\n          "content" : "MySQL的实战操作"\n        }\n      }\n    ]\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br")])])]),s._v(" "),n("li",[n("p",[s._v("然后对检索出来的实战的文档中，进行重新算分排序，包含"),n("code",[s._v("MySQL")]),s._v("的排名在前，增加算分")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('GET zfc-doc-000006/_search\n{\n  "query": {\n    "match": {\n      "content": "实战"\n    }\n  },\n  "rescore": {\n    "query": {\n      "rescore_query":{\n        "match":{\n          "title":"MySQL"\n        }\n      },\n      "query_weight" : 0.7,\n      "rescore_query_weight" : 1.2\n    },\n    "window_size": 50\n  }\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("上述查询语句的意思就是查询"),n("code",[s._v("content")]),s._v("字段中包含"),n("code",[s._v("”实战“")]),s._v("的文档，权重为"),n("code",[s._v("0.7")]),s._v("。并对文档中"),n("code",[s._v("title")]),s._v("为"),n("code",[s._v("MySQL")]),s._v("的文档增加评分，权重为"),n("code",[s._v("1.2")]),s._v("，"),n("code",[s._v("window_size")]),s._v("为"),n("code",[s._v("50")]),s._v("，表示取分片结果的前"),n("code",[s._v("50")]),s._v("进行重新算分")]),s._v(" "),n("p",[s._v("响应结果如下，可以看到"),n("code",[s._v("title")]),s._v("为"),n("code",[s._v("MySQL实战")]),s._v("的评分已经变为"),n("code",[s._v("0.9")]),s._v("，远远的超过了"),n("code",[s._v("title")]),s._v("为"),n("code",[s._v("ES实战")]),s._v("的文档")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    "hits" : [\n      {\n        "_index" : "zfc-doc-000006",\n        "_id" : "2",\n        "_score" : 0.9022989,\n        "_source" : {\n          "title" : "MySQL实战",\n          "content" : "MySQL的实战操作"\n        }\n      },\n      {\n        "_index" : "zfc-doc-000006",\n        "_id" : "1",\n        "_score" : 0.46697137,\n        "_source" : {\n          "title" : "ES实战",\n          "content" : "ES的实战操作，实战要领，实战经验"\n        }\n      }\n    ]\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])])])]),s._v(" "),n("h1",{attrs:{id:"总结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),n("p",[s._v("通过"),n("code",[s._v("rescore_query")]),s._v("我们可以对检索结果进行二次评分，增加自己更复杂的评分逻辑，提供更准确的结果排序，但是相应的也会增加查询的计算成本与响应时间。")]),s._v(" "),n("p",[s._v("在"),n("a",{attrs:{href:"https://mp.weixin.qq.com/s/a2kCZdm5x8Sri-n-8AfpDg",target:"_blank",rel:"noopener noreferrer"}},[s._v("《一篇文章让你学会Elasticsearch中的查询》"),n("OutboundLink")],1),s._v("一文中，我们学习了修改算分的几种方式，本文学习了如何在检索结果返回之后对检索结果进行更精细的二次评分排序。后面推出一篇专门修改算分的文章，以此来实现工作中的修改算分的需求。")]),s._v(" "),n("p",[s._v("如果感觉本文对你有所帮助欢迎点赞评论转发收藏。如果你想了解更多关于ES的骚操作，更多实战经验，欢迎关注。")])])}),[],!1,null,null,null);n.default=t.exports}}]);